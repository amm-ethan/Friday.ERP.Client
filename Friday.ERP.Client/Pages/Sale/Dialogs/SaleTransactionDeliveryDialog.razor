@using Friday.ERP.Shared.DataTransferObjects
<MudDialog>
    <DialogContent>
        <MudForm @ref="_form" @bind-IsValid="@_success" @bind-Errors="@_errors">
            <MudGrid Spacing="2">
                <CustomLabelAndStringField FirstText="Address" @bind-BindValue="@Address" Required="true"/>
                <CustomLabelAndStringField FirstText="Contact Person" @bind-BindValue="@ContactPerson" Required="true"/>
                <CustomLabelAndStringField FirstText="Contact Phone" @bind-BindValue="@ContactPhone" Required="true"/>

            </MudGrid>
            <MudDivider DividerType="DividerType.FullWidth" Class="my-4"/>
            <MudGrid Spacing="2">
                <CustomLabelAndStringField FirstText="Delivery Service Name" @bind-BindValue="@DeliveryServiceName"/>
                <CustomLabelAndStringField FirstText="Contact Person" @bind-BindValue="@DeliveryServiceContactPerson"/>
                <CustomLabelAndStringField FirstText="Contact Phone" @bind-BindValue="@DeliveryServiceContactPhone"/>
            </MudGrid>
            <MudDivider DividerType="DividerType.FullWidth" Class="my-4"/>
            <MudGrid Spacing="2">
                <CustomLabelAndStringField FirstText="Remark" @bind-BindValue="@Remark"/>
            </MudGrid>
            <MudDivider DividerType="DividerType.FullWidth" Class="mt-4"/>
        </MudForm>
    </DialogContent>
    <DialogActions>
        <CustomButton
            Label="Cancel" OnClick="@Back" Color="Color.Default" Variant="Variant.Text" FullWidth="false"/>
        <CustomButton
            Label="Make Purchase" OnClick="@Submit" Variant="Variant.Text" FullWidth="false"/>
    </DialogActions>
</MudDialog>

@code {

    [CascadingParameter] MudDialogInstance? MudDialog { get; set; }

    [Parameter] public string? Address { get; set; }
    [Parameter] public string? ContactPerson { get; set; }
    [Parameter] public string? ContactPhone { get; set; }
    [Parameter] public string? DeliveryServiceName { get; set; }
    [Parameter] public string? DeliveryServiceContactPerson { get; set; }
    [Parameter] public string? DeliveryServiceContactPhone { get; set; }
    [Parameter] public string? Remark { get; set; }

    MudForm? _form;
    bool _success;
    string[] _errors = [];

    async Task Submit()
    {
        await _form!.Validate();
        if (_form.IsValid)
        {
            var dataToReturn = new InvoiceSaleDeliveryCreateDto(
                Address!,
                ContactPerson!,
                ContactPhone!,
                DeliveryServiceName,
                DeliveryServiceContactPerson,
                DeliveryServiceContactPhone,
                Remark);
            MudDialog!.Close(DialogResult.Ok(dataToReturn));
        }
    }

    void Back()
    {
        MudDialog!.Cancel();
    }

}